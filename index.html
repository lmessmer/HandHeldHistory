<!DOCTYPE html>
<html lang="en">
<head>
  <title>HandHeldHistory</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />
  <!-- calls arcgis api CSS and JS library -->
  <link rel="stylesheet" href="https://js.arcgis.com/4.28/esri/themes/light/main.css">
  <script src="https://js.arcgis.com/4.28/"></script>


 
  <script>  
    require([
      "esri/config", 
      "esri/Map", 
      "esri/views/MapView",
      "esri/widgets/Locate",
      "esri/widgets/BasemapGallery",
      "esri/widgets/BasemapGallery/support/PortalBasemapsSource",
      "esri/widgets/Search",
      "esri/Graphic",  
      "esri/layers/GraphicsLayer",
      "esri/layers/FeatureLayer",
      "esri/widgets/Editor",
      "esri/widgets/Legend",
      "esri/widgets/Expand",
      "esri/widgets/LayerList",
      "esri/renderers/SimpleRenderer",
      "esri/symbols/SimpleFillSymbol"
      
    ], function(esriConfig, Map, MapView, Locate, BasemapGallery, PortalBasemapsSource, Search, Graphic, GraphicsLayer, 
    FeatureLayer, Editor, Legend, Expand, LayerList, SimpleRenderer, SimpleFillSymbol) {   

      esriConfig.apiKey = "AAPKc722771c0ccc42f6b3a50f98f0541437noDYBlU0Z8XIJioQe0FCEDxsHh9fAgIj7WZTgQnwd8Iro4vn-CgJSPt4wG7YeNvj"
      const map = new Map({ 
        basemap: "arcgis-light-gray"
      });
      
      const view = new MapView({
          map: map,
          center: [-90.13, 44.44], // longitude, latitude
          zoom: 6,
          container: "viewDiv"
      });
      
      //const graphicsLayer = new GraphicsLayer();  
      //map.add(graphicsLayer);


      const locateBtn = new Locate({view: view});
      view.ui.add(locateBtn, {position: "top-left"});


      const basemapGallery = new BasemapGallery({
        view: view,
        source: {
          portal: "https://arcgis.com",
          filterFunction: async (item, index, basemaps) => {
            let bool = false;
            await item.load().then((loadedBasemap) => {
              if(loadedBasemap.title == "Light Gray Canvas"){
                bool = true;
              }
              if(loadedBasemap.title == "Imagery"){
                bool = true;
              }
              if(loadedBasemap.title == "Streets"){
                bool = true;
              }
            })
            return bool;
          }}
        });

        const basemapExpand = new Expand({
          expandIcon: "basemap",
          view: view,
          content: basemapGallery
        });
      view.ui.add(basemapExpand, "top-right" )

      const searchWidget = new Search({ view: view});
      view.ui.add(searchWidget, {position: "top-left", index: 0});

      let blueRenderer = {
        type: "simple",  
        symbol: {
        type: "simple-marker",  
        style: "diamond",
        size: 10,
        color: "blue",
        outline: {  
          width: 1,
          color: "white"
        }
        }
        };

        let redRenderer = {
        type: "simple",  
        symbol: {
        type: "simple-marker",  
        style: "diamond",
        size: 10,
        color: "red",
        outline: {  
          width: 1,
          color: "white"
        }
        }
        };

        let yellowRenderer = {
        type: "simple",  
        symbol: {
        type: "simple-marker",  
        style: "diamond",
        size: 10,
        color: "yellow",
        outline: {  
          width: 1,
          color: "white"
        }
        }
        };

        let orangeRenderer = {
        type: "simple",  
        symbol: {
        type: "simple-marker",  
        style: "diamond",
        size: 10,
        color: "orange",
        outline: {  
          width: 1,
          color: "white"
        }
        }
        };



      const servicePopup = {
        "title": "{name}",
        "content": "<b>Type of Place:</b> {type}<br><b>Date Added:</b> {add_date}<br><b>More Information:</b> <a href='{link}'>{link}</a><br>"
      }
      const buildingLayer = new FeatureLayer({
        url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/arcgis/rest/services/Historic_Buildings/FeatureServer",
        outFields: ["name","type", "add_date","link"],
        popupTemplate: servicePopup,
        renderer: blueRenderer
      });

      const siteLayer = new FeatureLayer({
        url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/arcgis/rest/services/Historic_Sites/FeatureServer",
        outFields: ["name", "type", "add_date","link"],
        popupTemplate: servicePopup,
        renderer: redRenderer
      });

      const structureLayer = new FeatureLayer({
        url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/arcgis/rest/services/Historic_Structures/FeatureServer",
        outFields: ["name", "type", "add_date","link"],
        popupTemplate: servicePopup,
        renderer: yellowRenderer
      });

      const objectLayer = new FeatureLayer({
        url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/arcgis/rest/services/Historic_Objects/FeatureServer",
        outFields: ["name", "type", "add_date","link"],
        popupTemplate: servicePopup,
        renderer: orangeRenderer
      });

      const districtLayer = new FeatureLayer({
        url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/arcgis/rest/services/Historic_District_Areas/FeatureServer",
        outFields: ["name", "type", "add_date","link"],
        popupTemplate: servicePopup,
      });

      districtLayer.renderer = new SimpleRenderer({
        symbol: new SimpleFillSymbol({
          color: "green",
          style: "backward-diagonal",
          outline: { color:"green", width:"1px"}
          

        })
      });

      map.add(objectLayer);
      map.add(structureLayer);
      map.add(siteLayer);
      map.add(districtLayer);
      map.add(buildingLayer);
      

      const layerList = new LayerList({
        view: view
      });
      const layerListExpand = new Expand({
        expandIcons: "layers",
        view: view,
        content: layerList
      });
      view.ui.add(layerListExpand, "bottom-right")

      const legend = new Legend({
        view: view
      });
      const legendExpand = new Expand({
        expandIcon: "legend",
        view: view,
        content: legend});
      view.ui.add(legendExpand, "bottom-right");
    

    });  

    
  </script>

  <!-- css opening full screen map -->
  <style>  
    html,  
    body,  
    #viewDiv {  
      padding-bottom: 0;  margin-bottom: 0; margin: 0;  height: 96%;  width: 100%;
    }  
  </style> 


</head>
<body>

  <div>
  <h1 style="text-align:center;font-size:100%;line-height: 5px">Welcome to HandHeldHistory!</h1>
  <h2 style = "text-align:center;font-size:80%;line-height: 20px; ">Here you can find Wisconsin sites on the National Register of Historic Places.<br> Data courtesy of the National Parks Service.</h2>
  </div>


  <div id="viewDiv"></div> 
</body>
</html>

